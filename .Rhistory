#perform Mood's Median Test
median_test(Elev.P50~Species, data = modelData)
library(ggplot2)
originalPlotTrees <- read.csv(file = "G:/R_Stuff/DroneLidarCode/extras/AdjustedTrees_AllPlots.csv", stringsAsFactors = FALSE)
# need to reshape the data so rows are associated with a person
p1 <- originalPlotTrees[, c(1:18, 42, 59, 60, 48)]
p2 <- originalPlotTrees[, c(1, 19:35, 42, 59, 60, 48)]
colnames(p1) <- c(
"TreeID",
"X",
"Y",
"Elevation",
"Height",
"HCB",
"MaxCrownDiameter",
"MinCrownDiameter",
"CrownRotation",
"R",
"G",
"B",
"DBH",
"LeanAngle",
"LeanAzimuth",
"StatusCode",
"TopX",
"TopY",
"PlotID",
"OrigX",
"OrigY",
"Species"
)
colnames(p2) <- colnames(p1)
p1$Person <- 1
p2$Person <- 2
comp <- p1[, c(1, 19, 22, 23)]
comp$diff <- sqrt((p1$X - p2$X) * (p1$X - p2$X) +(p1$Y - p2$Y) * (p1$Y - p2$Y))
comp$diffTop <- sqrt((p1$TopX - p2$TopX) * (p1$TopX - p2$TopX) +(p1$TopY - p2$TopY) * (p1$TopY - p2$TopY))
comp$PlotID <- as.factor(comp$PlotID)
p <- rbind(p1, p2)
cat("Trees for adjustment:\n")
table(comp$Species)
p$Person <- as.factor(p$Person)
p$PlotID <- as.factor(p$PlotID)
p$Species <- as.factor(p$Species)
p$BaseDiffX <- p$X - p$OrigX
p$BaseDiffY <- p$Y - p$OrigY
p$BaseDiff <- sqrt(p$BaseDiffX * p$BaseDiffX + p$BaseDiffY * p$BaseDiffY)
p$TopDiffX <- p$X - p$TopX
p$TopDiffY <- p$Y - p$TopY
p$TopDiff <- sqrt(p$TopDiffX * p$TopDiffX + p$TopDiffY * p$TopDiffY)
bp <- ggplot(p, aes(x=PlotID, y=BaseDiff, col = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(p, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(p, aes(x=PlotID, y=BaseDiff, fill = Person, col = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
is.outlier <- function (x) {
x < quantile(x, .25) - 1.5 * IQR(x) |
x > quantile(x, .75) + 1.5 * IQR(x)
}
newp <- p
newp %>% group_by(Person) %>%
mutate(outlier.p = is.outlier(BaseDiff)) %>%
ungroup() -> newp
# original plot
bp <- ggplot(p, aes(x=PlotID, y=BaseDiff, col = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person, col = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person, col = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person, col = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
#  geom_point(data = newp[newp$outlier.p,], aes(x=PlotID, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
#  geom_point(data = newp[newp$outlier.p,], aes(x=PlotID, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], position=position_dodge2(width = 1, padding = 0.2), aes(x=PlotID, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = "black") +
geom_point(data = newp[newp$outlier.p,], position=position_dodge2(width = 1, padding = 0.2), aes(x=PlotID, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(BaseDiff)) %>%
ungroup() -> newp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = "black") +
geom_point(data = newp[newp$outlier.p,], position=position_dodge2(width = 1, padding = 0.2), aes(x=PlotID, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = "black") +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
newp$PlotID1 <- as.integer(newp$PlotID) - 0.2
View(newp)
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = "black") +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
adjustX <- function (x, y) {
if (y == 1)
t <- x - 0.2
else
t <- x + 0.2
return(t)
}
newp <- p
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(BaseDiff)) %>%
mutate(PlotID1 = adjustX(PlotID, Person)) %>%
ungroup() -> newp
adjustX <- function (x, y) {
t <- x
for (i in 1:length(x)) {
if (y[i] == 1)
t[i] <- x[i] - 0.2
else
t[i] <- x[i] + 0.2
}
return(t)
}
newp <- p
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(BaseDiff)) %>%
mutate(PlotID1 = adjustX(PlotID, Person)) %>%
ungroup() -> newp
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(BaseDiff)) %>%
mutate(PlotID1 = adjustX(PlotID, as.integer(Person))) %>%
ungroup() -> newp
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(BaseDiff)) %>%
mutate(PlotID1 = adjustX(as.integer(PlotID), as.integer(Person))) %>%
ungroup() -> newp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = "black") +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
legend.title = "Analyst",
text = element_text(size=14)
)
bp
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
legend.title = element_text("Analyst"),
text = element_text(size=14)
)
bp
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Person)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
legend.text = "Analyst",
text = element_text(size=14)
)
bp
names(newp)[names(newp) == 'Person'] <- 'Analyst'
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Analyst)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Analyst)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
bp
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(p, aes(x=PlotID, y=TopDiff, col = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted top locations (m)") +
coord_cartesian(ylim=c(0,4)) +
theme(
legend.position = c(0.9, 0.75),
text = element_text(size=14)
)
bp
newp <- p
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(TopDiff)) %>%
mutate(PlotID1 = adjustX(as.integer(PlotID), as.integer(Person))) %>%
ungroup() -> newp
names(newp)[names(newp) == 'Person'] <- 'Analyst'
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=TopDiff, fill = Person)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Analyst)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted top locations (m)") +
coord_cartesian(ylim=c(0,4)) +
theme(
legend.position = c(0.9, 0.75),
text = element_text(size=14)
)
bp
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=TopDiff, fill = Analyst)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Analyst)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted top locations (m)") +
coord_cartesian(ylim=c(0,4)) +
theme(
legend.position = c(0.9, 0.75),
text = element_text(size=14)
)
bp
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=TopDiff, fill = Analyst)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=TopDiff, col = Analyst)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted top locations (m)") +
coord_cartesian(ylim=c(0,4)) +
theme(
legend.position = c(0.9, 0.75),
text = element_text(size=14)
)
bp
newp <- p
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(BaseDiff)) %>%
mutate(PlotID1 = adjustX(as.integer(PlotID), as.integer(Person))) %>%
ungroup() -> newp
names(newp)[names(newp) == 'Person'] <- 'Analyst'
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=BaseDiff, fill = Analyst)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=BaseDiff, col = Analyst)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted base locations (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
legend.position = c(0.9, 0.85),
text = element_text(size=14)
)
#bp
tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_A.tif",
compression = "lzw", width = 6, height = 5, units = "in", res = 600)
print(bp)
dev.off()
# original plot
# bp <- ggplot(p, aes(x=PlotID, y=BaseDiff, col = Person)) +
#   geom_boxplot(position=position_dodge2(width = 1, padding = 0.2)) +
#   xlab("Plot identifier") +
#   ylab("Distance between field and \nadjusted base locations (m)") +
#   coord_cartesian(ylim=c(0,8)) +
#   theme(
#     legend.position = c(0.9, 0.85),
#     text = element_text(size=14)
#   )
# #bp
# tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_A.tif",
#      compression = "lzw", width = 6, height = 5, units = "in", res = 600)
# print(bp)
# dev.off()
newp <- p
newp %>% group_by(PlotID, Person) %>%
mutate(outlier.p = is.outlier(TopDiff)) %>%
mutate(PlotID1 = adjustX(as.integer(PlotID), as.integer(Person))) %>%
ungroup() -> newp
names(newp)[names(newp) == 'Person'] <- 'Analyst'
# new plot with colored boxes and outliers and black outlines, "Person" changed to "Analyst"
bp <- ggplot(newp, aes(x=PlotID, y=TopDiff, fill = Analyst)) +
geom_boxplot(position=position_dodge2(width = 1, padding = 0.2), outlier.color = NA) +
geom_point(data = newp[newp$outlier.p,], aes(x=PlotID1, y=TopDiff, col = Analyst)) +
xlab("Plot identifier") +
ylab("Distance between field and \nadjusted top locations (m)") +
coord_cartesian(ylim=c(0,4)) +
theme(
legend.position = c(0.9, 0.75),
text = element_text(size=14)
)
#bp
tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_B.tif",
compression = "lzw", width = 6, height = 3, units = "in", res = 600)
print(bp)
dev.off()
# old plot
# bp <- ggplot(p, aes(x=PlotID, y=TopDiff, col = Person)) +
#   geom_boxplot(position=position_dodge2(width = 1, padding = 0.2)) +
#   xlab("Plot identifier") +
#   ylab("Distance between field and \nadjusted top locations (m)") +
#   coord_cartesian(ylim=c(0,4)) +
#   theme(
#     legend.position = c(0.9, 0.75),
#     text = element_text(size=14)
#   )
# #bp
# tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_B.tif",
#      compression = "lzw", width = 6, height = 3, units = "in", res = 600)
# print(bp)
# dev.off()
bp <- ggplot(comp, aes(x=PlotID, y=diff, group = PlotID)) +
geom_boxplot(show.legend = FALSE) +
xlab("Plot identifier") +
ylab("Distance between base locations \nfor analysts 1 and 2 (m)") +
coord_cartesian(ylim=c(0,5)) +
theme(
text = element_text(size=14)
)
#bp
tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_C.tif",
compression = "lzw", width = 6, height = 3.5, units = "in", res = 600)
print(bp)
dev.off()
# look at difference in locations for tree tops. I expected this to have smaller overall differences
# but not really the case. Overall differences for plot are smaller but still under a meter for most trees.
# Larger differences are due to mismatched trees.
bp <- ggplot(comp, aes(x=PlotID, y=diffTop, group = PlotID)) +
geom_boxplot(show.legend = FALSE) +
xlab("Plot identifier") +
ylab("Distance between top locations \nfor analysts 1 and 2 (m)") +
coord_cartesian(ylim=c(0,8)) +
theme(
text = element_text(size=14)
)
bp
View(p)
# look at difference in locations for tree tops. I expected this to have smaller overall differences
# but not really the case. Overall differences for plot are smaller but still under a meter for most trees.
# Larger differences are due to mismatched trees.
bp <- ggplot(comp, aes(x=PlotID, y=diffTop, group = PlotID)) +
geom_boxplot(show.legend = FALSE) +
xlab("Plot identifier") +
ylab("Distance between top locations \nfor analysts 1 and 2 (m)") +
coord_cartesian(ylim=c(0,5)) +
theme(
text = element_text(size=14)
)
bp
bp <- ggplot(comp, aes(x=PlotID, y=diff, group = PlotID)) +
geom_boxplot(show.legend = FALSE) +
xlab("Plot identifier") +
ylab("Distance between base locations \nfor analysts 1 and 2 (m)") +
coord_cartesian(ylim=c(0,5)) +
theme(
text = element_text(size=14)
)
#bp
tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_B.tif",
compression = "lzw", width = 6, height = 3.5, units = "in", res = 600)
print(bp)
dev.off()
# look at difference in locations for tree tops. I expected this to have smaller overall differences
# but not really the case. Overall differences for plot are smaller but still under a meter for most trees.
# Larger differences are due to mismatched trees.
bp <- ggplot(comp, aes(x=PlotID, y=diffTop, group = PlotID)) +
geom_boxplot(show.legend = FALSE) +
xlab("Plot identifier") +
ylab("Distance between top locations \nfor analysts 1 and 2 (m)") +
coord_cartesian(ylim=c(0,5)) +
theme(
text = element_text(size=14)
)
#bp
tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_C.tif",
compression = "lzw", width = 6, height = 5, units = "in", res = 600)
print(bp)
dev.off()
#bp
tiff("G:/Bob's Stuff/Documents/FY23/Papers/DF_WH_Classification/RcodeFigures/Comparison_C.tif",
compression = "lzw", width = 6, height = 3.5, units = "in", res = 600)
print(bp)
dev.off()
View(p)
